(this["webpackJsonpproyecto-f"]=this["webpackJsonpproyecto-f"]||[]).push([[0],{35:function(e,t,s){},65:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),r=s(17),n=s.n(r),i=(s(35),s(20)),l=s(3),o=s(4),u=s.n(o),p=s(6),x=s(7),j=s.n(x),m=s(18),b=(s(55),s(66)),d=s(67),h=s(2),f=function(){var e=Object(l.g)(),t=Object(a.useRef)(null),s=Object(a.useRef)(null);function c(){return(c=Object(p.a)(u.a.mark((function a(c){var r,n,i,l,o;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(c.preventDefault(),r=t.current.value,n=s.current.value,r&&n){a.next=6;break}return Object(m.b)("Ingrese sus credenciales",{type:"error"}),a.abrupt("return");case 6:return a.prev=6,a.next=9,j.a.post("https://posts-pw2021.herokuapp.com/api/v1/auth/signin",{username:r,password:n});case 9:200===(i=a.sent).status&&(localStorage.setItem("token",i.data.token),localStorage.setItem("role",i.data.role),e("/")),a.next=19;break;case 13:a.prev=13,a.t0=a.catch(6),l=a.t0.response,o="",401===l.status?o="Datos Erroneos, intente de nuevo":500===l.status?o="Error con el servidor":404===l.status&&(o="Usuario inexistente"),Object(m.b)(o,{type:"warning"});case 19:case"end":return a.stop()}}),a,null,[[6,13]])})))).apply(this,arguments)}return Object(h.jsxs)("form",{className:"text-white flex flex-col justify-center items-center mx-auto  w-80 max-w-screen-sm h-screen md:w-auto",onSubmit:function(e){return c.apply(this,arguments)},children:[Object(h.jsx)(m.a,{}),Object(h.jsxs)("div",{className:"space-y-5",children:[Object(h.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(h.jsxs)("label",{className:"text-lg font-medium text-center",htmlFor:"L-username",children:[Object(h.jsx)(b.b,{className:"h-5 w-5 items-center inline-flex mr-3"}),"Username"]}),Object(h.jsx)("input",{className:"rounded-lg px-2 py-1 text-gray-600",id:"L-username",type:"text",placeholder:"Username",ref:t})]}),Object(h.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(h.jsxs)("label",{className:"text-lg font-medium text-center",htmlFor:"L-password",children:[Object(h.jsx)(d.a,{className:"h-5 w-5 items-center inline-flex mr-3"}),"Password"]}),Object(h.jsx)("input",{className:"rounded-lg px-2 py-1 text-gray-600",id:"L-password",type:"password",placeholder:"Password",ref:s})]}),Object(h.jsx)("button",{className:"rounded-2xl w-full bg-gray-500 py-2",type:"submit",children:"Login"})]})]})},O=s(5),y=s(72),g=s(68),v=function(){return Object(h.jsx)("div",{className:"absolute top-0 left-0 z-20 bg-gray-100 h-screen w-screen bg-opacity-50 flex justify-center items-center ",children:Object(h.jsx)(g.a,{className:"stroke w-8 h-8 stroke animate-spin "})})},w=s(10),N=s(30),k=s(29),S=s.n(k),I=s(70),F=s(71),A=function(e){var t=e.info,s=t.description,a=t.user;return Object(h.jsxs)("div",{className:"border-t-2 my-3",children:[Object(h.jsxs)("h1",{className:" nt-2 my-2 font-small text-yellow-200 text-sn",children:["@",a.username]}),Object(h.jsx)("p",{className:"text-xs font-small pl-4",children:s})]})},D=function(e){var t=e.idPost,s=e.afterSubmit,c=Object(a.useState)(""),r=Object(O.a)(c,2),n=r[0],i=r[1];function l(){return(l=Object(p.a)(u.a.mark((function e(a){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),c={description:n},e.next=4,j.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/comment/".concat(t),c,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 4:i(""),s(c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsx)("form",{className:"w-full",onSubmit:function(e){return l.apply(this,arguments)},children:Object(h.jsx)("input",{value:n,onChange:function(e){i(e.target.value)},className:"px-4 py-2 w-full rounded-2xl my-2 text-gray-800 border-2 border-white text-xs",type:"text",placeholder:"Comentar"})})},z=s(69),B=function(e){var t=e.id;function s(){return(s=Object(p.a)(u.a.mark((function e(s){var a,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),a=new FormData(s.target),c=Object.fromEntries(a.entries()),r=Array.from(a.values()),r.every((function(e){return""!==e}))){e.next=7;break}return e.abrupt("return",alert("Complete todos los campos para continuar"));case 7:return e.next=9,j.a.put("https://posts-pw2021.herokuapp.com/api/v1/post/update/".concat(t),Object(w.a)(Object(w.a)({},c),{},{active:"on"===c.active}),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 9:e.sent;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("form",{id:"form",onSubmit:function(e){return s.apply(this,arguments)},className:"bg-white bg-opacity-20 mt-3 p-3 text-gray-200 font-bol space-y-3",children:[Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"title",children:"Title"}),Object(h.jsx)("input",{className:"text-gray-600 px-2 py-1 my-1",type:"text",name:"title",id:"title"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"description",children:"Description"}),Object(h.jsx)("input",{className:"text-gray-600 px-2 py-1 my-1",type:"text",name:"description",id:"description"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"image",children:"Image"}),Object(h.jsx)("input",{className:"text-gray-600 px-2 py-1 my-1",type:"text",name:"image",id:"image"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"active",children:"Active"}),Object(h.jsx)("input",{className:"text-red-500 w-4 h-4 mr-2 focus:ring-red-500 focus:ring-opacity-25 border border-gray-200 rounded  ",type:"checkbox",name:"active",id:"active"})]}),Object(h.jsxs)("button",{type:"submit",className:"bg-green-500 w-full rounded-2xl text-center items-center flex py-2 justify-center font-bold",children:[Object(h.jsx)(z.a,{className:"mr-5 h-6 w-6"}),"Publish"]})]})},C=function(e){var t=e.username,s=e.post,c=s._id,r=s.title,n=s.description,i=s.image,l=s.user,o=s.createdAt,x=s.likes,m=s.comments,f=Object(a.useState)(!1),y=Object(O.a)(f,2),g=y[0],v=y[1],k=Object(a.useState)(m),z=Object(O.a)(k,2),C=z[0],E=z[1],P=Object(a.useState)(x.some((function(e){return e.username===t}))),L=Object(O.a)(P,2),T=L[0],U=L[1],J=Object(a.useState)(x.length),R=Object(O.a)(J,2),_=R[0],M=R[1];function q(){return(q=Object(p.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/like/".concat(c),{},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:T?(M(_-1),U(!1)):(M(_+1),U(!0)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function G(){return(G=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/toggle/".concat(c),null,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:t=e.sent,t.data,this.props.history.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"flex flex-col flex-initial bg-gray-200 bg-opacity-40 rounded-2xl md:w-8/12 p-3 text-white my-3",children:[Object(h.jsxs)("div",{className:"w-full flex space-around font-bold ",children:[Object(h.jsxs)("h1",{className:"w-1/2",children:["@",null===l||void 0===l?void 0:l.username]}),Object(h.jsx)("h2",{className:" text-right w-1/2 ",children:new Date(o).toLocaleDateString()})]}),Object(h.jsx)("img",{className:" w-full h-30 object-cover my-2 rounded-2xl",src:i,alt:r}),Object(h.jsxs)("div",{className:"w-full flex flex-col font-medium rounded-2xl text-sm space-y-3",children:[Object(h.jsx)("h1",{className:"",children:r}),Object(h.jsx)("h2",{className:"font-normal text-xs",children:n})]}),Object(h.jsxs)("div",{className:"w-full mt-4 flex justify-between\t",children:[Object(h.jsxs)("button",{onClick:function(){return q.apply(this,arguments)},type:"button",className:"flex space-x-3 text-xs justify-center items-center w-1/2 ".concat(T?" solid text-red-500":""," "),children:[Object(h.jsxs)("span",{children:[" ",Object(h.jsx)(I.a,{className:"w-5 h-5 mr-3"})]}),_]}),Object(h.jsxs)("button",{type:"button",className:"flex space-x-3 text-xs justify-center items-center w-1/2 ",children:[Object(h.jsxs)("span",{children:[" ",Object(h.jsx)(b.a,{className:"w-4 h-4 mr-3  text-white "})]}),C.length]}),Object(h.jsx)("button",{className:"flex space-x-3 text-xs justify-center items-center w-1/2",onClick:function(){return G.apply(this,arguments)},children:Object(h.jsxs)("span",{children:[" ",Object(h.jsx)(F.a,{className:" text-red-600 w-6 h-6 mr-3"})]})}),Object(h.jsxs)("div",{children:[g&&Object(h.jsx)(B,{id:c}),Object(h.jsx)("button",{className:"flex space-x-3 text-xs justify-center items-center w-1/2",onClick:function(){return v(!g)},children:Object(h.jsxs)("span",{children:[" ",Object(h.jsx)(d.b,{className:"text-white-600 w-6 h-6 mr-3"})]})})]})]}),Object(h.jsxs)("div",{children:[C.map((function(e){return Object(h.jsx)(A,{info:e},S.a.generate())})),Object(h.jsx)(D,{idPost:c,afterSubmit:function(e){E([].concat(Object(N.a)(C),[Object(w.a)(Object(w.a)({},e),{},{user:{username:t}})]))}})]})]})},E=function(e){var t=e.username,s=Object(a.useState)({loading:!0,data:[]}),c=Object(O.a)(s,2),r=c[0],n=c[1];return Object(a.useEffect)((function(){function e(){return(e=Object(p.a)(u.a.mark((function e(){var t,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("https://posts-pw2021.herokuapp.com/api/v1/post/all?limit=30&page=0",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:t=e.sent,s=t.data,n({loading:!1,data:s.data});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.loading?Object(h.jsx)(v,{}):Object(h.jsx)("div",{className:"flex flex-wrap px-6 mt-2 justify-center items-center ",children:r.data.map((function(e){return Object(h.jsx)(C,{username:t,post:e},e._id)}))})},P=function(){function e(){return(e=Object(p.a)(u.a.mark((function e(t){var s,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s=new FormData(t.target),a=Object.fromEntries(s.entries()),c=Array.from(s.values()),c.every((function(e){return""!==e}))){e.next=7;break}return e.abrupt("return",alert("Complete todos los campos para continuar"));case 7:return e.next=9,j.a.post("https://posts-pw2021.herokuapp.com/api/v1/post/create",Object(w.a)(Object(w.a)({},a),{},{active:"on"===a.active}),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 9:e.sent;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("form",{id:"form",onSubmit:function(t){return e.apply(this,arguments)},className:"bg-white bg-opacity-20 mt-3 p-3 text-gray-200 font-bol space-y-3",children:[Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"title",children:"Title"}),Object(h.jsx)("input",{className:"text-gray-600 px-2 py-1 my-1",type:"text",name:"title",id:"title"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"description",children:"Description"}),Object(h.jsx)("input",{className:"text-gray-600 px-2 py-1 my-1",type:"text",name:"description",id:"description"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"image",children:"Image"}),Object(h.jsx)("input",{className:"text-gray-600 px-2 py-1 my-1",type:"text",name:"image",id:"image"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm ",children:[Object(h.jsx)("label",{htmlFor:"active",children:"Active"}),Object(h.jsx)("input",{className:"text-red-500 w-4 h-4 mr-2 focus:ring-red-500 focus:ring-opacity-25 border border-gray-200 rounded  ",type:"checkbox",name:"active",id:"active"})]}),Object(h.jsxs)("button",{type:"submit",className:"bg-green-500 w-full rounded-2xl text-center items-center flex py-2 justify-center font-bold",children:[Object(h.jsx)(z.a,{className:"mr-5 h-6 w-6"}),"Publish"]})]})},L=function(){var e=Object(a.useState)(!1),t=Object(O.a)(e,2),s=t[0],c=t[1],r=Object(l.g)(),n=localStorage.getItem("token"),i=localStorage.getItem("role"),o=Object(a.useState)(""),x=Object(O.a)(o,2),m=x[0],b=x[1];return Object(a.useEffect)((function(){function e(){return(e=Object(p.a)(u.a.mark((function e(){var t,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("https://posts-pw2021.herokuapp.com/api/v1/auth/whoami",{headers:{Authorization:"Bearer ".concat(n)}});case 2:t=e.sent,s=t.data,b(s.username);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),null!=n||r("/login")}),[]),Object(h.jsxs)("div",{children:["admin"===i&&Object(h.jsxs)("div",{className:"px-8",children:[s&&Object(h.jsx)(P,{}),Object(h.jsx)("button",{onClick:function(){return c(!s)},type:"button",className:"w-full text-center flex justify-center mt-3 py-4 ",children:Object(h.jsx)(y.a,{className:"stroke text-white h-6 w-6 "})})]}),Object(h.jsx)(E,{username:m})]})},T=function(){return Object(h.jsx)("div",{className:"text-6x1 font-bold text-green-600",children:"POST TEST"})},U=function(e){var t=e.props;return console.log(t),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{children:Object(h.jsx)(l.a,{})})})},J=function(){return Object(h.jsx)(i.a,{children:Object(h.jsxs)(l.d,{children:[Object(h.jsxs)(l.b,{element:Object(h.jsx)(U,{}),children:[Object(h.jsx)(l.b,{exact:!0,path:"/",element:Object(h.jsx)(L,{})}),Object(h.jsx)(l.b,{exact:!0,path:"/Posts",element:Object(h.jsx)(T,{})})]}),Object(h.jsx)(l.b,{exact:!0,path:"/login",element:Object(h.jsx)(f,{})})]})})};n.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(J,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.b0c4bfeb.chunk.js.map